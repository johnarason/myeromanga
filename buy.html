<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no" />
  <title>JOHN.EROブックス - 人妻欲情物語</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(180deg, #121212 0%, #1c1c1c 100%);
      color: #fff;
      -webkit-font-smoothing: antialiased;
    }

    header {
      background-color: #ff69b4;
      color: white;
      padding: 16px 20px;
      font-size: 24px;
      text-align: center;
      font-weight: bold;
      box-shadow: 0 2px 8px rgba(0,0,0,0.4);
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    main {
      padding: 20px;
      max-width: 900px;
      margin: 0 auto;
    }

    .book-info {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      align-items: flex-start;
      background: #1e1e1e;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(255,105,180,0.3);
    }

    .cover {
      flex: 1 1 250px;
      max-width: 250px;
    }

    .cover img {
      width: 100%;
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(0,0,0,0.6);
    }

    .details {
      flex: 2 1 300px;
    }

    .title {
      font-size: 26px;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .rating {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
      font-size: 18px;
    }

    .stars {
      font-size: 20px;
      color: gold;
    }

    .meta {
      font-size: 14px;
      color: #ccc;
      line-height: 1.6;
      margin-bottom: 15px;
    }

    .btn {
      display: inline-block;
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      background: linear-gradient(45deg, #ff69b4, #ff85c1);
      color: white;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      margin-right: 10px;
      text-align: center;
      transition: transform 0.2s;
    }
    .btn:hover {
      transform: scale(1.05);
    }

    /* モーダル */
    #sampleModal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.9);
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 2000;
    }
    #sampleModal img {
      max-width: 90%;
      max-height: 80%;
      border-radius: 6px;
      box-shadow: 0 0 8px rgba(255,255,255,0.2);
    }
    #closeModal {
      margin-top: 20px;
      background: #ff69b4;
      border: none;
      color: #fff;
      padding: 10px 20px;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
    }

    /* レビューセクション */
    .review-section {
      margin-top: 40px;
      background: #1e1e1e;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(255,105,180,0.3);
    }

    .review-section h2 {
      margin-bottom: 16px;
      font-size: 20px;
    }

    .review-form {
      margin-bottom: 20px;
    }

    .review-form input,
    .review-form textarea,
    .review-form select {
      width: 100%;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 6px;
      border: none;
      font-size: 14px;
      box-sizing: border-box;
    }

    .review-form textarea {
      min-height: 60px;
      resize: vertical;
    }

    .review {
      background: #2a2a2a;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 12px;
      border: 1px solid #444;
    }

    .review-title {
      font-weight: bold;
      margin-bottom: 4px;
      color: #fff;
    }

    .review-stars {
      color: gold;
      font-size: 16px;
    }

    .average-rating {
      font-size: 16px;
      margin-bottom: 10px;
      color: #ccc;
    }

    /* スマホ */
    @media (max-width: 600px) {
      .book-info {
        flex-direction: column;
        text-align: center;
      }
      .details {
        text-align: center;
      }
    }
  </style>
</head>
<body>

<header>JOHN.EROブックス</header>

<main>
  <!-- 作品情報 -->
  <div class="book-info">
    <div class="cover">
      <img src="PP.png" alt="表紙画像" />
    </div>
    <div class="details">
      <div class="title">人妻欲情物語</div>
      <div class="rating">
        <div class="stars" id="averageStars">★★★★★</div>
        <div class="average-rating" id="ratingSummary">5.0 (1件)</div>
      </div>
      <div class="meta">
        <div>作者：ジョン</div>
        <div>ジャンル：エロ</div>
        <div>ページ数：1</div>
      </div>
      <button class="btn" onclick="openSample()">試し読み</button>
      <button class="btn" onclick="location.href='https://qr.paypay.ne.jp/p2p01_qGB4hP6JhnVhu4KG'">購入する</button>
    </div>
  </div>

  <!-- レビュー -->
  <div class="review-section">
    <h2>レビュー</h2>
    <div class="review-form">
      <input type="text" id="reviewTitle" placeholder="レビュータイトル" maxlength="50" />
      <select id="reviewStars">
        <option value="5">★★★★★ (5)</option>
        <option value="4">★★★★☆ (4)</option>
        <option value="3">★★★☆☆ (3)</option>
        <option value="2">★★☆☆☆ (2)</option>
        <option value="1">★☆☆☆☆ (1)</option>
      </select>
      <textarea id="reviewContent" placeholder="レビュー内容" maxlength="500"></textarea>
      <button class="btn" onclick="submitReview()">レビューを投稿</button>
    </div>
    <div id="reviewList"></div>
  </div>
</main>

<!-- モーダル試し読み -->
<div id="sampleModal">
  <img src="PPs.png" alt="試し読み" />
  <button id="closeModal" onclick="closeSample()">閉じる</button>
</div>

<script>
  const reviewList = [];
  const reviewContainer = document.getElementById("reviewList");
  const ratingSummary = document.getElementById("ratingSummary");
  const averageStars = document.getElementById("averageStars");

  function renderReviews() {
    reviewContainer.innerHTML = "";
    if (reviewList.length === 0) {
      ratingSummary.textContent = "レビューはまだありません";
      averageStars.textContent = "☆☆☆☆☆";
      return;
    }
    let totalStars = 0;
    reviewList.forEach(r => totalStars += r.stars);
    const avg = (totalStars / reviewList.length).toFixed(1);

    // 星の平均値を表示
    averageStars.textContent = "★★★★★".slice(0, avg >= 5 ? 5 : Math.round(avg)) + "☆☆☆☆☆".slice(0, 5 - Math.round(avg));
    ratingSummary.textContent = `${avg} (${reviewList.length}件)`;

    reviewList.forEach(r => {
      const div = document.createElement("div");
      div.className = "review";
      div.innerHTML = `
        <div class="review-title">${escapeHtml(r.title)}</div>
        <div class="review-stars">${"★".repeat(r.stars)}${"☆".repeat(5 - r.stars)}</div>
        <div class="review-content">${escapeHtml(r.content)}</div>
      `;
      reviewContainer.appendChild(div);
    });
  }

  function submitReview() {
    const title = document.getElementById("reviewTitle").value.trim();
    const content = document.getElementById("reviewContent").value.trim();
    const stars = parseInt(document.getElementById("reviewStars").value);
    if (!title || !content) {
      alert("レビュータイトルと内容を入力してください。");
      return;
    }
    reviewList.push({ title, content, stars });
    document.getElementById("reviewTitle").value = "";
    document.getElementById("reviewContent").value = "";
    renderReviews();
  }

  function escapeHtml(text) {
    return text.replace(/[&<>"']/g, (m) => ({ "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;" }[m]));
  }

  // 試し読みモーダル
  function openSample() {
    document.getElementById("sampleModal").style.display = "flex";
  }
  function closeSample() {
    document.getElementById("sampleModal").style.display = "none";
  }

  renderReviews();
</script>

</body>
</html>
